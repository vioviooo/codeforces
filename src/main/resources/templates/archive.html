<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Archive</title>-->
<!--    &lt;!&ndash; WebJars Bootstrap CSS &ndash;&gt;-->
<!--    <link href="/webjars/bootstrap/5.3.1/css/bootstrap.min.css" rel="stylesheet">-->
<!--    &lt;!&ndash; WebJars Bootstrap JS &ndash;&gt;-->
<!--    <script src="/webjars/bootstrap/5.3.1/js/bootstrap.bundle.min.js"></script>-->
<!--    <style>-->
<!--        body {-->
<!--            background-color: #f4f4f4;-->
<!--            padding: 20px;-->
<!--        }-->
<!--        .profile-card {-->
<!--            max-width: 800px;-->
<!--            margin: auto;-->
<!--            background: #fff;-->
<!--            border-radius: 10px;-->
<!--            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);-->
<!--            padding: 20px;-->
<!--        }-->
<!--        .profile-header {-->
<!--            text-align: center;-->
<!--            margin-bottom: 20px;-->
<!--        }-->
<!--        .profile-header h1 {-->
<!--            margin: 0;-->
<!--        }-->
<!--    </style>-->
<!--    <script>-->
<!--        // let showAllArchive = true;-->

<!--        async function fetchArchive() {-->
<!--            try {-->
<!--                const endpoint = "/archive-problems";-->
<!--                const response = await fetch(endpoint);-->
<!--                const archiveData = await response.json();-->

<!--                const tableBody = document.getElementById('archive-table-body');-->
<!--                tableBody.innerHTML = '';-->

<!--                archiveData.forEach(problem => {-->
<!--                    const row = document.createElement('tr');-->

<!--                    const userProblems = problem.userProblems.length > 0-->
<!--                        ? problem.userProblems[0]-->
<!--                        : { status: 'Not Attempted', attempts: 0, solvedAt: 'N/A' };-->

<!--                    row.innerHTML = `-->
<!--            <td>${problem.problemId}</td>-->
<!--            <td>${problem.title}</td>-->
<!--            <td>${problem.difficulty}</td>-->
<!--            <td>${problem.statement}</td>-->
<!--            <td>${userProblems.status}</td>-->
<!--            <td>${userProblems.attempts}</td>-->
<!--            <td>${userProblems.solvedAt == null ? "N/A" : formatDate(userProblems.solvedAt)}</td>-->
<!--          `;-->

<!--                    tableBody.appendChild(row);-->
<!--                });-->
<!--            } catch (error) {-->
<!--                console.error("Error fetching archive data:", error);-->
<!--                const tableBody = document.getElementById('archive-table-body');-->
<!--                tableBody.innerHTML = `<tr><td colspan="7" class="text-center text-danger">Failed to load archive data.</td></tr>`;-->
<!--            }-->
<!--        }-->

<!--        function formatDate(dateString) {-->
<!--            if (dateString === 'N/A') return 'N/A';-->

<!--            const options = {-->
<!--                month: 'long',-->
<!--                day: 'numeric',-->
<!--                hour: 'numeric',-->
<!--                minute: 'numeric',-->
<!--                timeZone: 'Europe/Moscow',-->
<!--                hour12: true-->
<!--            };-->

<!--            const date = new Date(dateString);-->
<!--            return `${date.toLocaleString('en-US', options)} MSK`;-->
<!--        }-->

<!--        function toggleArchiveView() {-->
<!--            showAllArchive = !showAllArchive;-->
<!--            const toggleButton = document.getElementById('toggle-archive-button');-->
<!--            toggleButton.innerText = showAllArchive ? 'Show Solved Problems' : 'Show All Problems';-->
<!--            fetchArchive();-->
<!--        }-->

<!--        document.addEventListener('DOMContentLoaded', fetchArchive);-->
<!--    </script>-->
<!--</head>-->
<!--<body>-->
<!--&lt;!&ndash; Sidebar &ndash;&gt;-->
<!--<button class="btn btn-primary position-absolute top-0 start-0 m-3" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebar" aria-controls="sidebar">-->
<!--    <span class="navbar-toggler-icon"></span>-->
<!--</button>-->
<!--<div class="offcanvas offcanvas-start" tabindex="-1" id="sidebar" aria-labelledby="sidebarLabel">-->
<!--    <div class="offcanvas-header">-->
<!--        <h5 class="offcanvas-title" id="sidebarLabel">Menu</h5>-->
<!--        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>-->
<!--    </div>-->
<!--    <div class="offcanvas-body">-->
<!--        <ul class="list-group mb-4">-->
<!--            <li class="list-group-item"><a href="/profile" class="text-decoration-none">Profile</a></li>-->
<!--            <li class="list-group-item"><a href="/contest" class="text-decoration-none">Contest</a></li>-->
<!--            <li class="list-group-item"><a href="/archive" class="text-decoration-none">Archive</a></li>-->
<!--        </ul>-->
<!--        <button class="btn btn-danger w-100" onclick="logout()">Log Out</button>-->
<!--    </div>-->
<!--</div>-->

<!--&lt;!&ndash; Archive Page &ndash;&gt;-->
<!--<div class="profile-card">-->
<!--    <div class="profile-header">-->
<!--        <h1 class="mb-4">Archive</h1>-->
<!--        <button id="toggle-archive-button" class="btn btn-secondary mb-3" onclick="toggleArchiveView()">Show My Archive</button>-->
<!--    </div>-->
<!--    <div class="table-responsive">-->
<!--        <table class="table table-bordered table-hover">-->
<!--            <thead class="table-dark">-->
<!--            <tr>-->
<!--                <th>â„–</th>-->
<!--                <th>Title</th>-->
<!--                <th>Difficulty</th>-->
<!--                <th>Statement</th>-->
<!--                <th>Status</th>-->
<!--                <th>Attempts</th>-->
<!--                <th>Solved At</th>-->
<!--            </tr>-->
<!--            </thead>-->
<!--            <tbody id="archive-table-body">-->
<!--            &lt;!&ndash; Archive data will be dynamically loaded here &ndash;&gt;-->
<!--            </tbody>-->
<!--        </table>-->
<!--    </div>-->
<!--</div>-->

<!--<script>-->
<!--    async function logout() {-->
<!--        try {-->
<!--            const response = await fetch("/auth/logout", {-->
<!--                method: "POST",-->
<!--                headers: {-->
<!--                    "Content-Type": "application/json"-->
<!--                }-->
<!--            });-->

<!--            if (response.ok) {-->
<!--                alert("Logged out successfully!");-->
<!--                window.location.href = "/login";-->
<!--            } else {-->
<!--                alert("Failed to log out!");-->
<!--            }-->
<!--        } catch (error) {-->
<!--            console.error("Error logging out:", error);-->
<!--        }-->
<!--    }-->
<!--</script>-->
<!--</body>-->
<!--</html>-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archive</title>
    <!-- WebJars Bootstrap CSS -->
    <link href="/webjars/bootstrap/5.3.1/css/bootstrap.min.css" rel="stylesheet">
    <!-- WebJars Bootstrap JS -->
    <script src="/webjars/bootstrap/5.3.1/js/bootstrap.bundle.min.js"></script>
    <style>
        body {
            background-color: #f4f4f4;
            padding: 20px;
        }
        .profile-card {
            max-width: 800px;
            margin: auto;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }
        .profile-header {
            text-align: center;
            margin-bottom: 20px;
        }
        .profile-header h1 {
            margin: 0;
        }
    </style>
    <script>
        async function fetchArchive() {
            try {
                const endpoint = "/archive-problems";
                const response = await fetch(endpoint);
                const archiveData = await response.json();

                const tableBody = document.getElementById('archive-table-body');
                tableBody.innerHTML = '';

                archiveData.forEach(problem => {
                    const row = document.createElement('tr');

                    const userProblems = problem.userProblems.length > 0
                        ? problem.userProblems[0]
                        : { status: 'Not Attempted', attempts: 0, solvedAt: 'N/A' };

                    row.innerHTML = `
                        <td>${problem.problemId}</td>
                        <td>${problem.title}</td>
                        <td>${problem.difficulty}</td>
                        <td>${problem.statement}</td>
                        <td>${userProblems.status}</td>
                        <td>${userProblems.attempts}</td>
                        <td>${userProblems.solvedAt == null ? "N/A" : formatDate(userProblems.solvedAt)}</td>
                    `;

                    tableBody.appendChild(row);
                });
            } catch (error) {
                console.error("Error fetching archive data:", error);
                const tableBody = document.getElementById('archive-table-body');
                tableBody.innerHTML = `<tr><td colspan="7" class="text-center text-danger">Failed to load archive data.</td></tr>`;
            }
        }

        function formatDate(dateString) {
            if (dateString === 'N/A') return 'N/A';

            const options = {
                month: 'long',
                day: 'numeric',
                hour: 'numeric',
                minute: 'numeric',
                timeZone: 'Europe/Moscow',
                hour12: true
            };

            const date = new Date(dateString);
            return `${date.toLocaleString('en-US', options)} MSK`;
        }

        document.addEventListener('DOMContentLoaded', fetchArchive);
    </script>
</head>
<body>
<!-- Sidebar -->
<button class="btn btn-primary position-absolute top-0 start-0 m-3" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebar" aria-controls="sidebar">
    <span class="navbar-toggler-icon"></span>
</button>
<div class="offcanvas offcanvas-start" tabindex="-1" id="sidebar" aria-labelledby="sidebarLabel">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="sidebarLabel">Menu</h5>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
        <ul class="list-group mb-4">
            <li class="list-group-item"><a href="/profile" class="text-decoration-none">Profile</a></li>
            <li class="list-group-item"><a href="/contest" class="text-decoration-none">Contest</a></li>
            <li class="list-group-item"><a href="/archive" class="text-decoration-none">Archive</a></li>
        </ul>
        <button class="btn btn-danger w-100" onclick="logout()">Log Out</button>
    </div>
</div>

<!-- Archive Page -->
<div class="profile-card">
    <div class="profile-header">
        <h1 class="mb-4">Archive</h1>
    </div>
    <div class="table-responsive">
        <table class="table table-bordered table-hover">
            <thead class="table-dark">
            <tr>
                <th>â„–</th>
                <th>Title</th>
                <th>Difficulty</th>
                <th>Statement</th>
                <th>Status</th>
                <th>Attempts</th>
                <th>Solved At</th>
            </tr>
            </thead>
            <tbody id="archive-table-body">
            <!-- Archive data will be dynamically loaded here -->
            </tbody>
        </table>
    </div>
</div>

<script>
    async function logout() {
        try {
            const response = await fetch("/auth/logout", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                }
            });

            if (response.ok) {
                alert("Logged out successfully!");
                window.location.href = "/login";
            } else {
                alert("Failed to log out!");
            }
        } catch (error) {
            console.error("Error logging out:", error);
        }
    }
</script>
</body>
</html>
